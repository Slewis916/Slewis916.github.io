---
layout: post
title:  Dynamic Malware Analysis
date:   2024-05-30 13:17:00 -0500
categories: blog 
description: Analyzing the behavior of malware on a Windows VM.
tags: homelabs 
---


To began the malware analysis, monitoring tools such as Process hacker are opened before executing the suspicious programs. Process hacker allows us to see the process activities. When the the malware is initiated, we should expect to see it under the explorer.exe process.

---
![Alert](/assets/img/dyn/1.png)
_Figure 1 Process hacker displaying current process activities_  

---

To see network activities, Wireshark is opened. It captures live packet data from the network interface.

---
![Alert](/assets/img/dyn/2.png)
_Figure 2 Process hacker displaying current process activities_  

---



Wireshark  was opened before the malware was executed to give an overview of the current network traffic.

## Analyze

RegShot is ran to view registry activities. A snapshot is taken of the system before any system changes by clicking ‘1st shot’, then shot. Checking the box for “scan dir1[;dir2;...;dir nn]” allows the RegShot to temporarily store it’s file in the designated folder.

![Alert](/assets/img/dyn/4.png)
_Figure 3 Regshot taking a snapshot before system changes_  

---

After taking a snap shot of the system, the suspicious program is extracted from zip file:  e-Archive Dekont.exe. Process monitor is opened and used to monitor child processes. The extracted file, 722ef401e5cbb067c5c33faa402774d3c75ef08e0c8cc4d7e66a9cfa53684088 is opened using the run as administrator command from the shortcut’s contextual menu. 

![Alert](/assets/img/dyn/5.png)
_Figure 4 Process monitor displaying the suspicious extracted file_  

---


After the suspicious file is opened and ran, Wireshark captures any traffic the file generates. The live capture is then halted to analyze the traffic generated from the file.

I filtered through the captured packets using 'dns'.

![Alert](/assets/img/dyn/6.png)
_Figure 5 Wireshark capturing halted after suspicious file opened_  

---



![Alert](/assets/img/dyn/7.png)
_Figure 6 Windows task schedular displaying the new malware_  

---




![Alert](/assets/img/dyn/8.png)
_Figure 7 Regshot capture of system after malware was executed_  

---